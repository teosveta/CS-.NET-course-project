/*
 * ============================================================================
 * БИБЛИОТЕЧНА СИСТЕМА - Базов клас за книга
 * ============================================================================
 * 
 * Проект по "Основи на програмиране на приложения с Microsoft Visual C# .NET"
 * 
 * Автор: Теосвета Красимирова Велкова
 * Факултетен номер: F108355
 * 
 * Дата на създаване: 2025
 * 
 * Описание на файла:
 * Този файл съдържа дефиницията на базовия клас Book (Книга).
 * Класът демонстрира основните ООП концепции:
 * - Енкапсулация (чрез свойства)
 * - Имплементация на интерфейс
 * - Виртуални методи (за полиморфизъм)
 * 
 * ООП Концепции в този клас:
 * 1. ЕНКАПСУЛАЦИЯ - данните са защитени чрез properties (свойства)
 * 2. ИНТЕРФЕЙСИ - класът имплементира IBorrowable интерфейса
 * 3. ПОЛИМОРФИЗЪМ - методът GetInfo() е virtual, за да може да се презапише
 * 
 * ============================================================================
 */

using System;

namespace LibraryProject
{
    /// <summary>
    /// Клас Book - представя обикновена книга в библиотеката.
    /// 
    /// Този клас е БАЗОВ КЛАС (parent/base class), от който могат да наследяват
    /// други класове като EBook. Имплементира интерфейса IBorrowable.
    /// </summary>
    public class Book : IBorrowable
    {
        /*
         * ========================================
         * СВОЙСТВА (Properties)
         * ========================================
         * 
         * ООП Концепция: ЕНКАПСУЛАЦИЯ
         * Свойствата (properties) ни позволяват да контролираме достъпа до данните.
         * Използваме автоматични свойства (auto-implemented properties) с формата:
         * public тип Име { get; set; }
         * 
         * Това е съкратен запис, който автоматично създава:
         * - private поле за съхранение на стойността
         * - get accessor за четене
         * - set accessor за записване
         */

        /// <summary>
        /// Заглавие на книгата.
        /// Пример: "Под игото", "1984", "Хари Потър"
        /// </summary>
        public string Title { get; set; }

        /// <summary>
        /// Автор на книгата.
        /// Пример: "Иван Вазов", "George Orwell"
        /// </summary>
        public string Author { get; set; }

        /// <summary>
        /// Година на издаване на книгата.
        /// Пример: 1894, 1949, 1997
        /// </summary>
        public int Year { get; set; }

        /// <summary>
        /// Флаг, показващ дали книгата е заета в момента.
        /// true = книгата е заета
        /// false = книгата е налична
        /// (Част от имплементацията на IBorrowable)
        /// </summary>
        public bool IsBorrowed { get; set; }

        /// <summary>
        /// Името на човека, който е заел книгата.
        /// Празен низ, ако книгата не е заета.
        /// (Част от имплементацията на IBorrowable)
        /// </summary>
        public string BorrowerName { get; set; }

        /*
         * ========================================
         * КОНСТРУКТОР (Constructor)
         * ========================================
         * 
         * Конструкторът е специален метод, който се извиква при създаване на обект.
         * Използва се за инициализация на свойствата на обекта.
         * Името на конструктора съвпада с името на класа.
         */

        /// <summary>
        /// Конструктор на класа Book.
        /// Създава нов обект от тип Book с посочените параметри.
        /// </summary>
        /// <param name="title">Заглавие на книгата</param>
        /// <param name="author">Автор на книгата</param>
        /// <param name="year">Година на издаване</param>
        public Book(string title, string author, int year)
        {
            // Инициализираме свойствата с подадените параметри
            Title = title;
            Author = author;
            Year = year;

            // При създаване книгата не е заета
            IsBorrowed = false;
            BorrowerName = "";
        }

        /*
         * ========================================
         * МЕТОДИ - ИМПЛЕМЕНТАЦИЯ НА ИНТЕРФЕЙСА
         * ========================================
         * 
         * Тези методи имплементират IBorrowable интерфейса.
         * Ключовата дума "virtual" позволява методът да бъде презаписан
         * в наследяващите класове (override).
         */

        /// <summary>
        /// Метод за заемане на книгата.
        /// Имплементира IBorrowable.Borrow()
        /// 
        /// Ключовата дума "virtual" означава, че методът може да бъде
        /// презаписан (override) в класове, които наследяват Book.
        /// </summary>
        /// <param name="borrowerName">Името на човека, който заема книгата</param>
        public virtual void Borrow(string borrowerName)
        {
            // Проверяваме дали книгата вече не е заета
            if (!IsBorrowed)
            {
                // Маркираме книгата като заета
                IsBorrowed = true;
                // Записваме името на заемателя
                BorrowerName = borrowerName;
            }
        }

        /// <summary>
        /// Метод за връщане на заетата книга.
        /// Имплементира IBorrowable.Return()
        /// 
        /// Ключовата дума "virtual" означава, че методът може да бъде
        /// презаписан (override) в класове, които наследяват Book.
        /// </summary>
        public virtual void Return()
        {
            // Маркираме книгата като налична
            IsBorrowed = false;
            // Изчистваме името на заемателя
            BorrowerName = "";
        }

        /*
         * ========================================
         * МЕТОДИ - ДОПЪЛНИТЕЛНИ
         * ========================================
         */

        /// <summary>
        /// Метод за получаване на информация за книгата като текст.
        /// 
        /// Ключовата дума "virtual" позволява на наследяващите класове
        /// да презапишат този метод и да добавят допълнителна информация.
        /// 
        /// ООП Концепция: ПОЛИМОРФИЗЪМ
        /// - Един и същи метод може да има различно поведение в различните класове
        /// - EBook ще има различна имплементация на GetInfo()
        /// </summary>
        /// <returns>Форматиран текст с информация за книгата</returns>
        public virtual string GetInfo()
        {
            // Определяме статуса на книгата
            string status;
            if (IsBorrowed)
            {
                status = "(Заета от " + BorrowerName + ")";
            }
            else
            {
                status = "(Налична)";
            }

            // Връщаме форматиран текст с информацията
            return Title + " - " + Author + " (" + Year + ") " + status;
        }

        /// <summary>
        /// Презаписване на стандартния метод ToString().
        /// ToString() се извиква автоматично когато обектът се преобразува в текст.
        /// 
        /// Ключовата дума "override" показва, че презаписваме метод от базовия клас Object.
        /// </summary>
        /// <returns>Текстово представяне на обекта</returns>
        public override string ToString()
        {
            // Използваме GetInfo() за да получим текстовото представяне
            return GetInfo();
        }
    }
}
